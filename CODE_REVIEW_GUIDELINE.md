# CODE_REVIEW_GUIDELINE

このリポジトリでレビュー担当が実施すべき項目を整理したガイドです。

## 1. 目的
- 受け入れ条件に対する実装妥当性を評価する。
- 本番影響の大きい不備（権限、整合性、並行実行、エラー処理）を早期に検出する。
- 修正方針が実装担当に伝わるレビューコメントを残す。

## 2. レビュー開始前チェック
- 対象Issueの受け入れ条件を確認する。
- PRの `関連Issue` に `Closes #<Issue番号>` があることを確認する。
- PR本文が `.github/pull_request_template.md` の構成に沿っていることを確認する。
- 実行テストと結果が記載されていることを確認する。

## 3. 重点レビュー観点
- 要件適合: 変更が受け入れ条件を満たしているか。
- セキュリティ: 認可漏れや権限昇格がないか。
- 整合性: 状態遷移やデータ参照が最新状態で検証されるか。
- 並行実行: 競合時に不正な予約/更新が起きないか。
- 失敗時挙動: API/UIで利用者に誤解を与える状態残りがないか。
- 保守性: 責務分離、命名、重複排除、テストの読みやすさが維持されているか。
- テスト充足: 開発者責任範囲（ドメイン単体/API結合）が受け入れ条件に対して十分か。

### 3.1 保守性の確認ポイント
- 1つのクラス/関数に責務が集中しすぎていないか。
- 将来変更が想定される値や条件がハードコードされていないか。
- 同じロジックが複数箇所に重複していないか（共通化候補があるか）。
- 例外系や境界条件を、追跡しやすいテストで説明できているか。
- コメントなしでは意図が読めない複雑分岐が増えていないか。

## 4. コメントルール
- レビューコメントは日本語で記載する。
- 指摘には優先度を付ける（`P1`/`P2`/`P3`）。
- 1コメントに以下を含める。
  - 問題の要約
  - 影響範囲（誰に何が起きるか）
  - 発生条件（再現条件）
  - 修正の方向性
- 仕様確認や補足提案は、ブロッカー指摘と分けて記載する。

## 5. 再レビューと判定
- 修正報告後は、指摘観点が解消されているかを再確認する。
- 解消済みなら「マージ可」を明記する。
- 指摘が残る場合は、未解消点を優先度付きで再提示する。
- 実装PRで不足観点が残る場合は、追加テストPRの作成を提案する。

## 6. 完了条件
- 受け入れ条件に対する重大な未解消リスクがない。
- 指摘事項の解消状況がPRコメントで追跡可能である。
- マージ判断の理由（可/不可）がPR上で明確になっている。
